{% load json_script %}

{% json_script variants "variant-data" %}



{% if clothing.gender == 'M' %}
    <p>Men • {{ clothing.category }}</p>

{% elif clothing.gender == 'F' %}
    <p>Women • {{ clothing.category }}</p>


{% elif clothing.gender == 'C' %}
    <p>Kids • {{ clothing.category }}</p>

{% elif clothing.gender == 'U' %}
    <p>Unisex •  {{ clothing.category }}</p>

{% endif %}

<p>S${{ clothing.price }}</p>
<a href="#reviews">{{ overall }} • ({{ num_reviews }})</a> 

<form action="" method="POST" style="margin-top: 10vh">
    {% csrf_token %}
  
    <label for="size">Size</label>
    <select title="size" id="size" value="size" name="size" style="height: 4vh">
        {% for item in sizes %}
            <option class="size-label" name="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select>


    <label for="color"></label>
    <select title="color" id="color" value="color" name="color" style="height: 4vh">
        {% for color, stock, size in variants %}    
            <option class="size-label" name="{{ color }}">{{ color }}</option>
        {% endfor %}
    </select>

</form>
<script>
    const size = JSON.parse(document.getElementById('variant-data').textContent);

    const filteredVariants = variantData.filter(variant => {
    return variant.size === size && variant.stock > 7;
    });
    const colorOptions = document.getElementById('colorOptions');
    colorOptions.innerHTML = '';  // Clear previous

    filteredVariants.forEach(variant => {
    const btn = document.createElement('button');
    btn.textContent = variant.color;
    btn.className = 'color-button';
    btn.onclick = () => {
        console.log(`Selected color: ${variant.color}`);
        // You can also update hidden inputs or trigger cart logic here
    };
    colorOptions.appendChild(btn);
    });

    if (filteredVariants.length === 0) {
        colorOptions.innerHTML = '<p>No colors available for this size with sufficient stock.</p>';
        }



</script>


{% for color, stock, quantity in variants %}


{% endfor %}

